---
title: ""
---

```{r, results='asis', echo=FALSE}
cat('
<div style="position: relative;">
<section class=\"image-container\">
  <img src=\"olympicswimming.png" style=\"width:100%;height:300px;object-fit:cover;opacity:\"/>
<div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: White;width: 80%;">
  <h1 style="font-size: 40px; ">Olympic Swimming History 1912-2020</h1>
</section>
</div>

<section id=\"introduction\" class=\"container\" width=\"100%\">
  <h4 class=\"text-center fw-bold my-4\">In light of the upcoming 2024 Paris Olympics, let us dive into some trends surrounding Olympic Swimming</h4>
  ')
```

```{r,echo=FALSE,message=FALSE}

# Load required R packages
library(tidyverse)
library(ggplot2)
library(highcharter)

# Load Data 
olympicswimming <- read.csv("/Users/janthinatan/Desktop/NM2207/Final Project/olympicswimming.csv")

#Filter out the medalists 
olympicmedalists <- olympicswimming %>% filter(Rank<4)

#load IOC code names
ioc_data<-read_csv("/Users/janthinatan/Desktop/NM2207/Final Project/ioc country codes.csv")

ioc_data <- ioc_data[c("Country", "NOC")]

olympicmedalists$Country <- ioc_data$Country[match(olympicmedalists$Team, ioc_data$NOC)]
```

```{r, echo=FALSE}

#Name countries whose IOC is not contained in IOC dataset 

# Find the row index where Team is "ROC"
roc_row_index <- which(olympicmedalists$Team == "ROC")

# Update the corresponding row in the "Country" column
olympicmedalists$Country[roc_row_index] <- "Russia"

# Find the row index where Team is "SGP"
roc_row_index <- which(olympicmedalists$Team == "SGP")

# Update the corresponding row in the "Country" column
olympicmedalists$Country[roc_row_index] <- "Singapore"

# Find the row index where Team is "ROU"
roc_row_index <- which(olympicmedalists$Team == "ROU")

# Update the corresponding row in the "Country" column
olympicmedalists$Country[roc_row_index] <- "Romania"

# Find the row index where Team is "USA"
roc_row_index <- which(olympicmedalists$Team == "USA")

# Update the corresponding row in the "Country" column
olympicmedalists$Country[roc_row_index] <- "United States of America"

# Find the row index where Team is "SRB"
roc_row_index <- which(olympicmedalists$Team == "SRB")

# Update the corresponding row in the "Country" column
olympicmedalists$Country[roc_row_index] <- "Serbia"

# Find the row index where Team is "NlD"
roc_row_index <- which(olympicmedalists$Team == "NLD")

# Update the corresponding row in the "Country" column
olympicmedalists$Country[roc_row_index] <- "Netherlands"

# Find the row index where Team is "TTO"
roc_row_index <- which(olympicmedalists$Team == "TTO")

# Update the corresponding row in the "Country" column
olympicmedalists$Country[roc_row_index] <- "Trinidad and Tobago "
```

```{r,echo=FALSE}
speed <-olympicmedalists%>% filter(Rank==1) %>% group_by(Distance..in.meters.,Stroke,Gender)
speed <- speed %>%
  mutate(EventType = paste(Gender,Distance..in.meters., Stroke, sep = " "))
```

The first modern Olympic Games were held in Athens in 1896. The first Olympics introduced some interesting races into the lineup, such us the 100m free for sailors which was strictly for members of the Greek Navy and all of the races were held in open water.

Until 1912, only male swimmers were allowed to compete in the Olympics. Women only began to compete at the Stockholm Olympics when they were finally allowed in water. In that year, they could only compete in the 100 free and 400 free relay.

```{r, echo=FALSE, message=FALSE}

speed2 <- speed %>%
  mutate(EventType2 = paste(Distance..in.meters., Stroke, sep = " "))
```

### Which Countries Have Been Most Dominant?

##### Here is a brief overview of the countries which have been most successful in Olympic Swimming. Zoom in to take a closer look!

```{r, results='asis', echo=FALSE}
cat('
<p align="center"><iframe src="https://janthina.shinyapps.io/InteractiveMap/" width=500 height="420"></iframe></p> ')
```

**At the 2020 Tokyo Olympics**, the **United States of America** took home **30 medals** in swimming, adding to the incredible haul of medals that it has been accumulating since the start of the Olympic Games. In comparison, **Australia** and **Japan** which are ranked second and third in the overall medal count only bagged **21** and **3** medals respectively. Additionally, **25%** **of total medals** won by the USA in the games that year came from **swimming** alone.

```{r, results='asis', echo=FALSE}
cat('
<p align="center"><iframe src="https://janthina.shinyapps.io/InteractiveBarChart/" width=500 height="420"></iframe></p> ')
```

### Swimming Results Over Time

##### How have Olympic swimming results changed over time?

**Olympic swimming performances have made significant improvements since 1912.** This is evident in the decrease in winning timings which we can observe for both the Men's and Women's events.

```{r,echo=FALSE,message=FALSE}

library(hms)
times<- speed$Results
times1 <-strsplit(times,split="\\.")
times2 <-sapply(times1,function(x) x[1])
timessd <-sapply(times1,function(x) x[2])
timessd <-sapply(timessd,function(x) substr(x,0,3))
times3 <-strsplit(times2,split=":")
times3 <-sapply(times3,rev)
times3 <-lapply(times3, function(x) {
  while (length(x) < 3) {
    x <-c(x, "0")
  }
  x
})

weights <- c(1,60,3600)
secs <-sapply(times3, function(x) {
  temp=0
  for(y in 1:length(x)) {
    temp = temp + strtoi(weights[y] * strtoi(x[y]))
  }
  temp
})
secs <- secs + as.numeric(as.numeric(timessd)/1000)
library(dplyr)
timef <- secs %>% hms(seconds = .)

speed$Results <- secs
```

```{r, results='asis', echo=FALSE}
cat('
<p align="center"><iframe src="https://janthina.shinyapps.io/overall_trend/" width=500 height="470"></iframe></p> ')
```

The reasons for improvement are due in part to advanced training procedures, increasingly sophisticated selection methods, superior stroke mechanics, increased access to the sport or even new swimwear technologies. Most importantly, this is possible due to the International Swimming Federation's openness in developing competition rules such as exploring new swimming techniques, swimmer's gear and swimwear as well as swimming pool equipment while ensuring that the final performance is determined by human skills and quality of training rather than technology.

### Improvement How?

##### Lets evaluate the nature of improvement in Olympic swimming.

<br>

```{r,echo=FALSE, message=FALSE, warning=FALSE}
speed2 <- speed %>%
  mutate(EventType2 = paste(Distance..in.meters., Stroke, sep = " "))

improvement <- speed2 %>%
  group_by(Gender,EventType2) %>%
  summarise(minR = min(Results, na.rm = T),
            maxR = max(Results, na.rm = T),
            rangeR = maxR - minR)

improvement <- subset(improvement, !(EventType2 %in% c("1500m Freestyle", "800m Freestyle", "400m Breaststroke", "4x100 Freestyle", "4x200 Freestyle", "4x100 Medley")))

hc3 <- improvement %>% 
  hchart('column', hcaes(x = 'EventType2', y = 'rangeR', group = "Gender")) %>%
  hc_colors(c("#0073C2FF", "#EFC000FF")) %>% 
  hc_title(text = "Improvement in Swimming Results Over Time") %>% 
  hc_subtitle(text= "By Event") %>% 
  hc_yAxis(title = list(text = "Improvement(seconds)")) %>% 
  hc_xAxis(title = list(text = "Event"))

hc3
```

Evidently, women have achieved a higher absolute improvement in swimming timings compared to men. This can be attributed to the lesser time that women have spent in the competitive swimming scene.

```{r, echo=FALSE, message=FALSE,warning=FALSE}

gold_medalist <-speed2 %>% filter(EventType2 == "100m Freestyle")

hc5 <- gold_medalist %>% 
  hchart(type = 'line', hcaes(x = Year, y = Results, group = Gender)) %>%
  hc_title(text = "100m Freestyle Results Over Time  ") %>%
  hc_subtitle(text = "Men vs Women Events")
hc5
```

Owing to a **greater rate of improvement in female swimmers**, we can observe a **diminishing difference** **between the results of female and male athletes.** Take for example the 100m Freestyle event, the 1952 difference between male and female gold medalists was 19.40 s and had dropped to 4.094 s by 2020.

```{r, echo=FALSE, message= FALSE}
rateofimprovement <- speed %>% group_by(Year, EventType) %>%
  summarise(mR = mean(Results, na.rm = T)) %>%
  group_by(EventType) %>%
  arrange(Year, .by_group = T) %>% 
  mutate(improv = mR - lag(mR)) %>% 
  na.omit

  
rateofimprovement$improv <- rateofimprovement$improv * -1
rateofimprovement$Gen <- sapply(strsplit(rateofimprovement$EventType, " "), function(x) x[1])

extract_middle_word <- function(text) {
  words <- strsplit(text, " ")[[1]]
  middle_index <- ceiling(length(words) / 2)
  return(words[middle_index])
}

# Apply the function to column1 and create column2
rateofimprovement$distance <- sapply(rateofimprovement$EventType, extract_middle_word)

Freestyle <- rateofimprovement %>% filter(EventType == "Men 400m Freestyle" | EventType == "Women 400m Freestyle"|  EventType == "Men 200m Freestyle" | EventType == "Women 200m Freestyle" | EventType == "Men 100m Freestyle" | EventType == "Women 100m Freestyle" )

Freestyle1 <- rateofimprovement %>% filter(EventType == "Men 100m Freestyle" | EventType == "Women 100m Freestyle")
Freestyle2 <- rateofimprovement %>% filter(EventType == "Men 200m Freestyle" | EventType == "Women 200m Freestyle")
Freestyle3 <- rateofimprovement %>% filter(EventType == "Men 400m Freestyle" | EventType == "Women 400m Freestyle")
```

<br>

### Is Swimming Performance Reaching its Peak

##### What are the limits of atheletic performance?

<br>

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center'}
ggplot(data=Freestyle, aes(x=Year, y=improv, group=Gen, color=Gen)) + geom_point () + geom_smooth() + xlim(1924, 2020) +facet_wrap(~Gen) +facet_wrap(~distance)
```

Despite female athletes improving at a faster rate than their male counterparts, both demographics are experiencing **improvements at decreasing rates**. Given years of rapid development that has occurred since 1912 within the spheres of human physiology, economics, global environment and more, performance in humans and animals have experiences a plateau in the last 20-30 years. (Berthelot et al.,2015)

<br>

### What does this mean for the Paris Olympics?

##### Will it be any less exciting?

```{r, results='asis', echo=FALSE}
cat('
<div style="position: relative;">
<section class=\"image-container\">
  <img src=\"olympics.png" style=\"width:100%;height:300px;object-fit:cover;opacity:\"/>
<div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: White;width: 80%;">
  <h1 style="font-size: 40px; "></h1>
</section>
</div>
')
```

<br>

Fortunately not. Technological innovations have the potential to alleviate the effects of stagnation, depending on the evolution of rules and regulations. Furthermore, while we might be missing out on an appearance by Phelps this year, there are still many new talents to lookout for!

<br>

```{r, echo=FALSE, message= FALSE,warning=FALSE}

freestylespeed <- speed <- speed %>%
  mutate(EventType = paste(Gender,Distance..in.meters., Stroke, sep = " ")) %>% na.omit

difference <- freestylespeed %>%
  select(Year, Gender, Results, Stroke, Distance..in.meters.) %>%
  pivot_wider(names_from = Gender, values_from = Results) %>% na.omit

```

```{r, echo=FALSE, message= FALSE,warning=FALSE}
freestylespeed <- speed2 %>% filter(Rank==1) %>% filter(Stroke == "Freestyle") %>% filter (Year == "2008") 

freestylespeed <- freestylespeed %>% arrange(EventType, Gender)

# Reshape data from wide to long format
difference<- freestylespeed %>%
  pivot_wider(names_from = Gender, values_from = Results) %>%
  mutate(EventType = gsub("\\s\\(.*", "", EventType2)) %>%
  pivot_longer(cols = c("Men", "Women"),
               names_to = "Gender",
               values_to = "Results")
```

**References:**

Berthelot G, Sedeaud A, Marck A, Antero-Jacquemin J, Schipman J, Saulière G, Marc A, Desgorces FD, Toussaint JF. Has Athletic Performance Reached its Peak? Sports Med. 2015 Sep;45(9):1263-1271. doi: 10.1007/s40279-015-0347-2. PMID: 26094000; PMCID: PMC4536275.

Stanula A, Maszczyk A, Roczniok R, Pietraszewski P, Ostrowski A, Zając A, Strzała M. The development and prediction of athletic performance in freestyle swimming. J Hum Kinet. 2012 May;32:97-107. doi: 10.2478/v10078-012-0027-3. Epub 2012 May 30. PMID: 23486223; PMCID: PMC3590874.
